<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>排行榜</title>
    <!-- 引入 Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 定义主题色变量 */
        :root {
            --primary-bg: #fffadb8f; /* 背景色 */
            --primary-text: #b65e00; /* 文本色 */
            --primary-accent: #3b82f6; /* 强调色 */
        }

        /* 背景图片和毛玻璃效果 */
        body {
            background-image: url("static/res/Background.png"); /* 假设 res/ 里有 background.jpg，替换为实际文件名 */
            background-size: cover;
            background-position: center;
            backdrop-filter: blur(10px); /* 毛玻璃效果 */
            -webkit-backdrop-filter: blur(8px); /* Safari 支持 */
        }

        /* 应用主题色到元素 */
        .theme-bg { background-color: var(--primary-bg); }
        .theme-text { color: var(--primary-text); }
        .theme-accent { color: var(--primary-accent); }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center">
    <div class="max-w-6xl w-full theme-bg shadow-lg rounded-lg p-6 bg-opacity-10"> <!-- 添加 bg-opacity-80 使背景半透明 -->
        <h1 class="text-5xl font-bold text-center theme-text mb-6">排行榜</h1>
        <div class="overflow-x-auto">
            <table class="min-w-full table-auto theme-bg border border-gray-200 rounded-lg">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-3 py-4 text-center text-3xl font-medium theme-text">排名</th>
                        <th class="px-6 py-4 text-center text-3xl font-medium theme-text">用户名</th>
                        <th class="px-6 py-4 text-center text-3xl font-medium theme-text">分数</th>
                        <th class="px-6 py-4 text-center text-3xl font-medium theme-text">时间</th>
                    </tr>
                </thead>
                <tbody id="leaderboard-body" class="divide-y divide-gray-200">
                    <!-- 数据将在这里动态插入 -->
                </tbody>
            </table>
        </div>
        <div id="loading" class="text-center theme-text mt-4">加载中...</div>
        <div id="error" class="text-center text-red-500 mt-4 hidden">加载失败，请稍后重试。</div>
    </div>

    <script>
        let isLoading = false;
        async function loadLeaderboard() {
            const loading = document.getElementById('loading');
            const error = document.getElementById('error');
            const tbody = document.getElementById('leaderboard-body');
            
            loading.style.display = 'block';
            error.classList.add('hidden');
            
            try {
                // 假设服务器在 localhost:5067，替换为你的公网 IP
                const response = await fetch('http://localhost:5067/leaderboard');
                if (!response.ok) throw new Error('网络错误');
                const data = await response.json();
                
                tbody.innerHTML = '';
                data.forEach((entry, index) => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50';
                    row.innerHTML = `
                        <td class="px-6 py-4 text-center text-3xl theme-text">${index + 1}</td>
                        <td class="px-6 py-4 text-center text-3xl theme-text">${entry.username}</td>
                        <td class="px-6 py-4 text-center text-3xl theme-text">${entry.score}</td>
                        <td class="px-6 py-4 text-center text-3xl theme-text">${entry.time}</td>
                    `;
                    tbody.appendChild(row);
                });
            } catch (err) {
                console.error('加载排行榜失败:', err);
                error.classList.remove('hidden');
            } finally {
                loading.style.display = 'none';
            }
        }
        
        // 页面加载时获取数据
        window.onload = () => {
            loadLeaderboard();
        };
    </script>
</body>
</html>